<!DOCTYPE html><html lang="en"><head><title>FX404Seconds</title><meta charset="utf-8"><meta name="author" content="DarknessFX - https://dfx.lv"><meta name="description" content="js13k Server Entry"><meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"><link async rel="manifest" href="m.json"><style>body,canvas,html{margin:0;border:0;padding:0;width:100%;height:100%;display:block;overflow:hidden;user-select:none;outline:0;touch-action:none;background-color:#000}#m0,#m00,#mp00{position:absolute;display:none}#m0{background-color:transparent;border:0;top:5px;right:5px;font-size:24pt;flex-grow:1;flex-shrink:1;z-index:2}#m00,#mp00{background-color:#483d8b;border:#303080 2px outset;padding:10px;min-height:32px;left:25vw;top:15vh;width:50%;height:60%;grid-template-columns:repeat(2,0fr);resize:vertical;overflow:auto;z-index:1;box-shadow:0 0 20px 10px #303030b0;animation:fadeIn ease 250ms;font-size:3em;color:#fff}#mp00{display:grid;grid-row:auto;text-align:center;grid-template-columns:unset}#m00 div,#mp00 div{display:inline-block}#m00 div{height:50%}#bBack,#bClose,#pName{font-size:1em}#pColor{height:80%}#dPX{border:5px ridge;overflow-y:auto;height:32vh;display:block}a{color:#fff}#Menu,h1{width:100%}#Menu{display:none;position:absolute;height:100%;padding-top:5vh;vertical-align:middle;background-color:#00000080}h1{background-color:transparent;font-size:5em;letter-spacing:15px;margin-top:10%;padding-bottom:15vh;transform:rotate(-25deg)}.idiv,.mdiv,h1{text-align:center}.idiv,h1{font-family:"Courier New";position:relative;z-index:2;color:#ffd63c;text-transform:uppercase;text-shadow:0 0 8px #000,3px 3px red,6px 6px #fff,9px 9px red,12px 12px #fff,15px 15px red,18px 18px #fff}.mdiv{padding-bottom:2%}.idiv{background-color:#d7d7d780;border:2px ridge;font-weight:700;width:40%;font-size:2em;padding:20px}.idiv:disabled{color:#303030;text-shadow:0 0 8px #000,3px 3px #303030,6px 6px silver,9px 9px #303030,12px 12px silver,15px 15px #303030,18px 18px silver}#dcnt{font-size:1.5em;font-weight:700;color:#60ff30;text-shadow:0 0 6px #000}@media screen and (max-width:1182px){#m00{grid-template-columns:repeat(1,0fr);font-size:1.5em;height:70%}} </style><link async rel="icon" href="i.png"><link async rel="apple-touch-icon" href="i.png"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"></head><body></body><script async defer>"use strict"; let cnv; let render = Worker; let ls = localStorage; let isnewplayer = false; let _player = {}; let emojilist = ["1F920", "1F973", "1F60E", "1F479", "1F47A", "1F47B", "1F47D", "1F47E", "1F916", "1F63A", "1F436", "1F649"]; const dev = (e) => { render.postMessage({type: "dev", value: e,}); }; const toBoolean = (e) => { return (e == "true") ? true : false }; const settingsSave = () => { isnewplayer = false; m00.style.display = "none"; ls.setItem("FX_Name", pName.value); ls.setItem("FX_Color", pColor.value); for (let i = 0; i < pStamp.length; i++) { if (pStamp[i].checked) { ls.setItem("FX_Stamp", i); break; } } ls.setItem("FX_Music", pMusic.checked); ls.setItem("FX_SFX", pSFX.checked); ls.setItem("FX_Dev", pDev.checked); dev(pDev.checked); _music_on = pMusic.checked; _sfx_on = pSFX.checked; startclick(); updateSound(); set_player(); settingsShow(); }; const settingsLoad = () => { m00.style.display = "grid"; if (isnewplayer) { pName.value = "Player" + (Math.floor(9999 * Math.random())).toString().padStart(4, "0"); pColor.value = "#" + Math.floor(Math.random()*16777215).toString(16); pStamp[Math.floor(Math.random()*12)].checked = true; pDev.checked = false; } else { settingsLoader(); } settingsShow(); }; const settingsLoader = () => { pName.value = ls.getItem("FX_Name"); pColor.value = ls.getItem("FX_Color"); pStamp[ls.getItem("FX_Stamp")].checked = true; pMusic.checked = toBoolean(ls.getItem("FX_Music")); pSFX.checked = toBoolean(ls.getItem("FX_SFX")); pDev.checked = toBoolean(ls.getItem("FX_Dev")); _music_on = pMusic.checked; _sfx_on = pSFX.checked; set_player(); }; const set_player = () => { _player = { pName: ls.getItem("FX_Name"), pColor: ls.getItem("FX_Color"), pStamp: ls.getItem("FX_Stamp"), } }; const settingsShow = () => { if (m0.style.display == "block") { m0.style.display = "none"; Menu.style.display = "none"; } else { m0.style.display = "block"; Menu.style.display = "block"; } if (sck_conn) { if ("btnMP" in window) { btnMP.disabled = false; dcnt.textContent = "Players Online : " + sck_cnt; } } }; const singlePlayer = () => { m0.style.display = "none"; Menu.style.display = "none"; render.postMessage({type: "state", state: 5}); render.postMessage({type: "game", player: _player}); }; (function () { function cleanStorage() { let lsKeys = 6; if (ls.length != lsKeys) { Object.keys(localStorage).forEach(key => { ls.removeItem(key); }); isnewplayer = true; } } cleanStorage(); (function () { document.body.innerHTML += "<div id=\"Menu\"><div><h1>404 Seconds</h1></div>" + "<div class=\"mdiv\"><input id=\"btnSP\" class=\"idiv\" type=\"button\" onclick=\"singlePlayer();\" value=\"Single Player\"></div>" + "<div class=\"mdiv\"><input id=\"btnMP\" disabled=\"false\" class=\"idiv\" type=\"button\" onclick=\"sck_MP();\" value=\"Multiplayer\"></div>" + "<div id=\"dcnt\" class=\"mdiv\"></div></div>"; document.body.innerHTML += "<div id=\"m00\">" + "<div>Nickname&nbsp;:&nbsp;</div><div><input id=\"pName\" type=\"text\" size=\"10\" maxlength=\"10\"></div>" + "<div>Color&nbsp;:&nbsp;</div><div><input id=\"pColor\" type=\"color\" style=\"width: 100%; height: 100%;\"></div>" + "<div>Stamp&nbsp;:&nbsp;</div><div id=\"emjlst\"></div>" + "<div>Audio&nbsp;:&nbsp;</div><div><input id=\"pMusic\" type=\"checkbox\" checked=\"true\">&#x1f3b5;<input id=\"pSFX\" type=\"checkbox\" checked=\"true\">&#x1f50a;</div>" + "<div>Credits&nbsp;:&nbsp;</div><div style=\"font-size: .6em; align-self: center;\" title=\"Developer Mode\"><nobr><input id=\"pDev\" type=\"checkbox\">&nbsp;&nbsp;DarknessFX&nbsp;<a href=\"https://dfx.lv\" target=\"_blank\">DFX.lv</a>&nbsp;&nbsp;<a href=\"https://twitter.com/DrkFX\" target=\"_blank\">@DrkFX</a></nobr><br>"+ "<a href=\"https://modarchive.org/index.php?request=view_by_moduleid&query=100235\" target=\"_blank\">Music by Psirius</a>&nbsp;" + "<a href=\"https://github.com/KilledByAPixel/ZzFX\" target=\"_blank\">ZzFX</a>&nbsp;" + "<a href=\"https://github.com/keithclark/ZzFXM\" target=\"_blank\">ZzFXM</a></div>" + "<div></div><div><br><input id=\"bClose\" type=\"button\" value=\" Save \" onclick=\"settingsSave();\"></div>" + "</div>"; const emojiload = function() { let idx = 0; for (const e of emojilist) { emjlst.innerHTML += "<div><input id=\"pStamp\" type=\"radio\" name=\"emoji\" value=\"" + idx + "\">&#x" + e + ";</div>"; idx++; } }(); })(); document.body.innerHTML += "<button id=\"m0\" title=\"Settings\" onclick=\"settingsLoad(true);\">&#x2699️&#xFE0F;</button>"; document.body.innerHTML += "<canvas id=\"c\">"; cnv = document.getElementById("c"); (function() { fetch("w.js").then(r => { r.text().then(r => { render = new Worker( "data:text/javascript;charset=US-ASCII," + r, { type: "module" }); }).then(r => { render.onmessage = e => { switch (e.data.type) { case "boot_end": if (!isnewplayer) { settingsLoader(); } else { settingsLoad(); } case "gameover": render.postMessage({type: "state", state: 2}); render.postMessage({type: "intro", mens: performance.now()}); settingsShow(); break; case "hit": playSFXH(); break; case "jump": playSFXJ(); break; default: break; } }; const coffscreen = cnv.transferControlToOffscreen(); render.postMessage({type: "canvas", canvas: coffscreen}, [coffscreen]); sendSize(); render.postMessage({type: "state", state: 1}); render.postMessage({type: "boot"}); }); }); }()); const sendSize = async () => { render.postMessage({ type: "size", width: cnv.clientWidth, height: cnv.clientHeight, }); }; window.addEventListener("resize", sendSize); const keyPress = async (e, b) => { let keyPressed = e; switch (keyPressed) { case "KeyW": case "ArrowUp": keyPressed = "P1U"; break; case "KeyS": case "ArrowDown": keyPressed = "P1D"; break; case "KeyA": case "ArrowLeft": keyPressed = "P1L"; break; case "KeyD": case "ArrowRight": keyPressed = "P1R"; break; case "ShiftLeft": case "Space": case "ShiftRight": case "NumpadEnter": keyPressed = "P1B1"; break; default: keyPressed = ""; } if (keyPressed != "") { render.postMessage({type: "control", input: keyPressed, status: b}); } return keyPressed; }; function keyDownHandler(e) { keyPress(e.code, true); }; function keyUpHandler(e) { keyPress(e.code, false); }; window.addEventListener("keydown", keyDownHandler, false); window.addEventListener("keyup", keyUpHandler, false); })();</script><script defer async>"use strict"; const loadMusic = async () => { buffer = zzfxM(...songData); updateSound(); }; const playMusic = async () => { zzfxX.resume(); }; const stopMusic = async () => { zzfxX.suspend(); }; let sfx = { jump: {}, hit: {},}; const loadSFX = async () => { sfx.jump = () => { zzfx(...[,,836,.02,.04,.13,1,1.31,3.9,,,,,,,,,.76,.07]); }; }; sfx.hit = () => { zzfx(...[3,,274,,,.43,1,2.19,-5.6,,,,,.3,,.4,.14,.91]); }; const playSFXJ = async () => { if (_sfx_on) sfx.jump(); }; const playSFXH = async () => { if (_sfx_on) sfx.hit(); }; let _1stclick = false, _music_on = true, _sfx_on = true, _isplaying=false; const updateSound = async () => { if (_music_on) { if (!_isplaying) { zzfxN = zzfxP(...buffer); zzfxN.loop = true; } _isplaying = true; } else { if (zzfxN != undefined) { zzfxN.stop(); _isplaying = false; } } }; const startclick = async (e) => { if (!_1stclick) { _1stclick = true; zzfxX = new AudioContext; zzfxR = 44100; zzfxV = 1; loadSFX(); loadMusic(); } }; window.onclick = startclick; window.ontouchstart = startclick; let zzfx,zzfxV,zzfxX,zzfxR,zzfxM,zzfxP,zzfxG,zzfxN,buffer; zzfx=(...t)=>zzfxP(zzfxG(...t)); zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),f=zzfxX.createBuffer(t.length,t[0].length,zzfxR);t.map((d,i)=>f.getChannelData(i).set(d)),e.buffer=f,e.connect(zzfxX.destination),e.start();return e}; zzfxG=(a=1,t=.05,h=220,M=0,n=0,s=.1,i=0,r=1,o=0,z=0,e=0,f=0,m=0,x=0,b=0,d=0,u=0,c=1,G=0,I=zzfxR,P=99+M*I,V=n*I,g=s*I,j=G*I,k=u*I,l=2*Math.PI,p=(a=>0<a?1:-1),q=P+j+V+g+k,v=(o*=500*l/I**2),w=(h*=(1+2*t*Math.random()-t)*l/I),y=p(b)*l/4,A=0,B=0,C=0,D=0,E=0,F=0,H=1,J=[])=>{for(;C<q;J[C++]=F)++E>100*d&&(E=0,F=A*h*Math.sin(B*b*l/I-y),F=p(F=i?1<i?2<i?3<i?Math.sin((F%l)**3):Math.max(Math.min(Math.tan(F),1),-1):1-(2*F/l%2+2)%2:1-4*Math.abs(Math.round(F/l)-F/l):Math.sin(F))*Math.abs(F)**r*a*zzfxV*(C<P?C/P:C<P+j?1-(C-P)/j*(1-c):C<P+j+V?c:C<q-k?(q-C-k)/g*c:0),F=k?F/2+(k>C?0:(C<q-k?1:(C-q)/k)*J[C-k|0]/2):F),A+=1-x+1e9*(Math.sin(C)+1)%2*x,B+=1-x+1e9*(Math.sin(C)**2+1)%2*x,h+=o+=500*z*l/I**3,H&&++H>f*I&&(h+=e*l/I,w+=e*l/I,H=0),m&&++D>m*I&&(h=w,o=v,D=1,H=H||1);return J}; zzfxM=(f,n,o,t=125)=>{let z,e,l,r,g,h,x,a,u,c,d,i,m,p,G,M,R=[],b=[],j=[],k=0,q=1,s={},v=zzfxR/t*60>>2;for(;q;k++)R=[q=a=d=m=0],o.map((t,d)=>{for(x=n[t][k]||[0,0,0],q|=!!n[t][k],G=m+(n[t][0].length-2-!a)*v,e=2,r=m;e<x.length+(d==o.length-1);a=++e){for(g=x[e],u=c!=(x[0]||0)|g|0,l=0;l<v&&a;l++>v-99&&u?i+=(i<1)/99:0)h=(1-i)*R[p++]/2||0,b[r]=(b[r]||0)+h*M-h,j[r]=(j[r++]||0)+h*M+h;g&&(i=g%1,M=x[1]||0,(g|=0)&&(R=s[[c=x[p=0]||0,g]]=s[[c,g]]||(z=[...f[c]],z[2]*=2**((g-12)/12),zzfxG(...z))))}m=G});return[b,j]}; const songData=[[[1.8,0,72,,,.2,,4,-2,6,50,.15,,6],[1.8,0,72,,,.2,,4,-2,6,50,.15,,6],[,0,22,,.07,.07,2,0,,,.5,.01],[,0,84,,,.1,,.7,,,,.5,,6.7,1,.05],[,0,23,,,.2,3,5,,,],[.9,0,38,.01,.05,.25,2,2,,,-8],[2,0,426,.01,.2,.48,,44,,,200,,,.1],[1.5,0,155,.01,,.2,2,.5,,,-270,.2,2,,.1,,.15],[.75,0,38,.01,.05,.25,2,2,,,-8],[,0,220,,,,3,0,,,320,,,4],[2,0,2600,.01,,.12,3,2,,,800,.02,,4.8,,.01,.1],[2,0,800,,,.075,2,2,,,1e3,-.01,.02,4.8,-.3,,.065],[,0,22,,.07,.07,2,0,,,.5,.01],[,0,22,,.07,.07,2,0,,,.5,.01],[.8,0,2100,,,.1,3,3,,,-400,,,2],[,0,22,,.07,.07,2,0,,,.5,.01],[,0,22,,.07,.07,2,0,,,.5,.01],[1.75,0,64,.02,.03,.3,2,14.2,-.1,,,,,1.1],[1.5,0,155,.01,,.2,2,.5,,,-270,.2,2,,.1,,.15],[2,0,426,.01,.2,.48,,44,,,200,,,.1],[2,0,426,.01,.2,.48,,44,,,200,,,.1],[,0,220,,,,3,0,,,320,,,4],[,0,23,,,.2,3,5,,,],[2,0,800,,,.075,2,2,,,1e3,-.01,.02,4.8,-.3,,.065],[2,0,800,,,.075,2,2,,,1e3,-.01,.02,4.8,-.3,,.065],[,0,22,,.07,.07,2,0,,,.5,.01]],[[[8,-1,27,,27.75,27,,27.75,27,,27.75,,27,,27,,25,,27,,27.75,27,,27.75,27,,27,,27.75,,27,,27.75,,27,,27.75,27,,27.75,27,,27.75,,27,,27,,25,,27,,27.75,27,,27.75,27,,27,,27.75,,27,,27.75,,],[25,1,29.01,,,,29.01,,,,32.01,,,,,,,,29.01,,,,29.01,,,,32.01,,,,,,,,29.01,,,,29.01,,,,32.01,,,,,,,,29.01,,,,29.01,,,,32.01,,29.01,,,29.01,29.01,,],[2,1,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,],[1,1,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,],[23,-1,,,,,,,,,,,30.01,22.01,25.01,,22.01,,,,,,,,,,,,,,,,,,,,,,,,,,,,30.01,22.01,25.01,,22.01,,,,,,,,,,,,,,,,,,],[24,1,,,,,,,,,,,29.22,,,,29.22,,,,,,,,,,,,29.22,,,,29.22,,,,,,,,,,,,29.22,,,,29.22,,,,,,,,,,,,,,,,,,],[17,1,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,,,,,,,,,,,,,29.01,,,,]],[[8,-1,27,,27.75,27,,27.75,27,,27.75,,27,,27,,25,,27,,27.75,27,,27.75,27,,27,,27.75,,27,,27.75,,27,,27.75,27,,27.75,27,,27.75,,27,,27,,25,,27,,27.75,27,,27.75,27,,27,,27.75,,27,,27.75,,]]],[1,0]]; </script><script async defer> if ("serviceWorker" in navigator) { sw = navigator.serviceWorker; sw.register("sw.js"); sw.onmessage = e => {}; }; </script><script src="./socket.io/socket.io.js"></script><script defer async>"use strict"; let sck; let sck_conn = false; let sck_cnt = 0; let save_menu = ""; let mp_lobby; try { sck = new io; sck.connect(); } catch (e) {}; window.onunload = (e) => { sck.disconnect(); }; sck.on("connect", function() { sck_conn = true; }); sck.on("count", function(msg){ sck_cnt = msg; }); sck.on("lobby", function(msg){ Menu.innerHTML = msg; mp_lobby = setInterval(() => { let _sec = dSec.textContent; dSec.textContent = _sec - 1; if (_sec <= 1) clearInterval(mp_lobby); }, 1000); }); sck.on("player_list", function(msg){ let dps = ""; for (let i = 0; i < msg.length; i++) { dps+= "<div style=\"display: inline; color: " + msg[i].pColor + ";\">&#x" + emojilist[msg[i].pStamp] + ";&nbsp;" + msg[i].pName + "</div><br/>"; } dPX.innerHTML = dps; }); sck.on("start", function(msg){ exit_MP(); render.postMessage({type: "queue", queue: msg}); singlePlayer(); }); const sck_MP = () => { sck.emit("player", _player); save_menu = Menu.innerHTML; Menu.innerHTML = ""; }; const exit_MP = () => { clearInterval(mp_lobby); sck.emit("player_exit", _player); Menu.innerHTML = save_menu; }; </script></html>